{% extends 'base.html' %}
{% load static %}

{% block title %}{{ produit.nom }} - Détail Produit{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/detail_produits.css' %}" />

{% endblock %}

{% block content %}
<div class="product-detail">
    <div class="product-container">
        <div class="product-grid">
            <!-- Section Image -->
            <div class="product-image-section">
             <img src="{{ produit.get_image }}" alt="{{ produit.nom }}" class="product-image">
            </div>


            <!-- Section Informations -->
            <div class="product-info">
                <h1 class="product-title">{{ produit.nom }}</h1>
                
                <!-- Badges -->
                <div class="product-badges">
                    {% if produit.nouveau %}
                        <span class="badge badge-nouveau">
                            <i class="fas fa-star"></i> Nouveau
                        </span>
                    {% endif %}
                    {% if produit.populaire %}
                        <span class="badge badge-populaire">
                            <i class="fas fa-fire"></i> Populaire
                        </span>
                    {% endif %}
                    <span class="badge badge-category">
                        <i class="fas fa-tag"></i> {{ produit.get_categorie_display }}
                    </span>
                </div>

                <!-- Prix -->
                <div class="product-price">{{ produit.prix }}</div>

                <!-- Détails du produit -->
                <div class="product-details">
                    <div class="detail-row">
                        <span class="detail-label">
                            <i class="fas fa-palette"></i> Couleur
                        </span>
                        <span class="detail-value">
                            {{ produit.get_couleur_display }}
                            <span class="color-indicator" style="background-color: {{ produit.couleur }};"></span>
                        </span>
                    </div>
                    
                    <div class="detail-row">
                        <span class="detail-label">
                            <i class="fas fa-layer-group"></i> Catégorie
                        </span>
                        <span class="detail-value">{{ produit.get_categorie_display }}</span>
                    </div>
                    
                    <div class="detail-row">
                        <span class="detail-label">
                            <i class="fas fa-boxes"></i> Stock
                        </span>
                        <span class="detail-value">
                            {% if produit.quantite_en_stock > 10 %}
                                <span class="stock-status stock-available">
                                    <i class="fas fa-check-circle"></i>
                                    {{ produit.quantite_en_stock }} en stock
                                </span>
                            {% elif produit.quantite_en_stock > 0 %}
                                <span class="stock-status stock-low">
                                    <i class="fas fa-exclamation-triangle"></i>
                                    Dernières pièces ({{ produit.quantite_en_stock }})
                                </span>
                            {% else %}
                                <span class="stock-status stock-out">
                                    <i class="fas fa-times-circle"></i>
                                    Rupture de stock
                                </span>
                            {% endif %}
                        </span>
                    </div>
                </div>

                <!-- Description -->
                {% if produit.description %}
                <div class="product-description">
                    <h3 class="description-title">
                        <i class="fas fa-info-circle"></i>
                        Description
                    </h3>
                    <p class="description-text">{{ produit.description|linebreaksbr }}</p>
                </div>
                {% endif %}

                <!-- Boutons d'action -->
                <div class="action-buttons">
                    {% if produit.quantite_en_stock > 0 %}
                     
                     

                        <form method="post" action="{% url 'ajouter_au_panier' produit.id %}" class="add-to-cart-form">
                            {% csrf_token %}
                            <button type="submit" class="btn btn-primary" data-id="{{ produit.id }}" class="btn add-to-cart-btn">
                                <i class="fas fa-shopping-cart"></i>
                                Ajouter au panier
                            </button>
                        </form>


                        <button class="btn btn-outline">
                            <i class="fas fa-heart"></i>
                            Ajouter aux favoris
                        </button>
                    {% else %}
                        <button class="btn btn-secondary" disabled>
                            <i class="fas fa-ban"></i>
                            Indisponible
                        </button>
                    {% endif %}
                    <a href="{% url 'liste_produits' %}" class="btn btn-outline">
                        <i class="fas fa-arrow-left"></i>
                        Retour à la liste
                    </a>
                </div>

                <!-- Date d'ajout -->
                <div class="date-added">
                    <i class="fas fa-calendar-plus"></i>
                    Ajouté le {{ produit.date_ajout|date:"d F Y" }}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
    <script src="{% static 'js/detail_produit.js' %}" defer></script>
{% endblock %}